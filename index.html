<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Gerador de Lista de Louvores</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <div class="container">
        <header class="app-header">
            <h1>📖 Gerador de Lista de Louvores</h1>
            <p class="subtitle">Crie e compartilhe suas listas de louvores</p>
        </header>

        <div class="search-section card">
            <h2 class="section-title">🔍 Buscar Louvores</h2>

            <div class="source-selector">
                <label class="source-label">Buscar em:</label>
                <label class="radio-option">
                    <input type="radio" name="source" id="sourceIgreja" value="Igreja">
                    <span>Igreja</span>
                </label>
                <label class="radio-option">
                    <input type="radio" name="source" id="sourceCias" value="CIAS">
                    <span>CIAS</span>
                </label>
                <label class="radio-option">
                    <input type="radio" name="source" id="sourceAvulsos" value="Avulsos">
                    <span>Avulsos</span>
                </label>
                <label class="radio-option">
                    <input type="radio" name="source" id="sourceTodas" value="Todas" checked>
                    <span>Todas</span>
                </label>
            </div>

            <div class="search-input-wrapper">
                <input
                    type="text"
                    id="searchInput"
                    placeholder="Digite o número ou título do louvor..."
                    autocomplete="off"
                >
                <span class="search-icon">🔎</span>
            </div>

            <div id="searchResults"></div>
        </div>

        <div class="list-section card">
            <div class="list-header">
                <div class="list-header-left">
                    <h2 class="section-title">📝 Lista Selecionada</h2>
                    <span id="songCounter" class="song-counter">0 louvores</span>
                </div>
                <div class="list-header-right">
                    <input
                        type="date"
                        id="listDate"
                        class="date-input"
                        title="Data da lista"
                    >
                    <button id="clearListBtn" class="btn btn-secondary" title="Limpar toda a lista">
                        🗑️ Limpar Lista
                    </button>
                </div>
            </div>

            <ul id="songList"></ul>

            <div class="export-section" id="exportSection" style="display: none;">
                <h3 class="export-title">📤 Compartilhar Lista</h3>

                <div class="export-options">
                    <div class="export-type">
                        <label class="radio-option">
                            <input type="radio" name="exportType" value="titles" checked>
                            <span>Apenas Títulos</span>
                        </label>
                        <label class="radio-option">
                            <input type="radio" name="exportType" value="lyrics">
                            <span>Com Letras</span>
                        </label>
                    </div>
                </div>

                <div class="export-buttons">
                    <button id="exportImageBtn" class="btn btn-primary">
                        🖼️ Gerar Imagem
                    </button>
                    <button id="exportTextBtn" class="btn btn-primary">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-whatsapp" viewBox="0 0 16 16">
                          <path d="M13.601 2.326A7.85 7.85 0 0 0 7.994 0C3.627 0 .068 3.558.064 7.926c0 1.399.366 2.76 1.057 3.965L0 16l4.204-1.102a7.9 7.9 0 0 0 3.79.965h.004c4.368 0 7.926-3.558 7.93-7.93A7.9 7.9 0 0 0 13.6 2.326zM7.994 14.521a6.6 6.6 0 0 1-3.356-.92l-.24-.144-2.494.654.666-2.433-.156-.251a6.56 6.56 0 0 1-1.007-3.505c0-3.626 2.957-6.584 6.591-6.584a6.56 6.56 0 0 1 4.66 1.931 6.56 6.56 0 0 1 1.928 4.66c-.004 3.639-2.961 6.592-6.592 6.592m3.615-4.934c-.197-.099-1.17-.578-1.353-.646-.182-.065-.315-.099-.445.099-.133.197-.513.646-.627.775-.114.133-.232.148-.43.05-.197-.1-.836-.308-1.592-.985-.59-.525-.985-1.175-1.103-1.372-.114-.198-.011-.304.088-.403.087-.088.197-.232.296-.346.1-.114.133-.198.198-.33.065-.134.034-.248-.015-.347-.05-.1-.445-1.076-.612-1.47-.16-.389-.323-.335-.445-.34-.114-.007-.247-.007-.38-.007a.73.73 0 0 0-.529.247c-.182.198-.691.677-.691 1.654s.71 1.916.81 2.049c.098.133 1.394 2.132 3.383 2.992.47.205.84.326 1.129.418.475.152.904.129 1.246.08.38-.058 1.171-.48 1.338-.943.164-.464.164-.86.114-.943-.049-.084-.182-.133-.38-.232"/>
                        </svg> Enviar Texto (WhatsApp)
                    </button>
                    <button id="exportLyricsBtn" class="btn btn-secondary" style="display: none;">
                        📝 Copiar Letras Individuais
                    </button>
                </div>
            </div>
        </div>

        <div class="saved-lists-section card">
            <h2 class="section-title">💾 Listas Salvas (Firebase)</h2>
            <div class="saved-lists-controls">
                <input
                    type="text"
                    id="listNameInput"
                    placeholder="Nome da lista..."
                    class="list-name-input"
                >
                <button id="saveListBtn" class="btn btn-success">
                    💾 Salvar Lista
                </button>
            </div>
            <div id="savedListsContainer"><div class="empty-message">Carregando listas...</div></div>
        </div>
    </div>

    <div id="imageModal" class="modal">
        <div class="modal-content">
            <span class="modal-close">&times;</span>
            <h3>Imagem da Lista de Louvores</h3>
            <canvas id="listCanvas"></canvas>
            <div class="modal-buttons">
                <button id="downloadImageBtn" class="btn btn-primary">
                    ⬇️ Baixar Imagem
                </button>
                <button id="shareImageBtn" class="btn btn-success">
                   <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-whatsapp" viewBox="0 0 16 16">
                     <path d="M13.601 2.326A7.85 7.85 0 0 0 7.994 0C3.627 0 .068 3.558.064 7.926c0 1.399.366 2.76 1.057 3.965L0 16l4.204-1.102a7.9 7.9 0 0 0 3.79.965h.004c4.368 0 7.926-3.558 7.93-7.93A7.9 7.9 0 0 0 13.6 2.326zM7.994 14.521a6.6 6.6 0 0 1-3.356-.92l-.24-.144-2.494.654.666-2.433-.156-.251a6.56 6.56 0 0 1-1.007-3.505c0-3.626 2.957-6.584 6.591-6.584a6.56 6.56 0 0 1 4.66 1.931 6.56 6.56 0 0 1 1.928 4.66c-.004 3.639-2.961 6.592-6.592 6.592m3.615-4.934c-.197-.099-1.17-.578-1.353-.646-.182-.065-.315-.099-.445.099-.133.197-.513.646-.627.775-.114.133-.232.148-.43.05-.197-.1-.836-.308-1.592-.985-.59-.525-.985-1.175-1.103-1.372-.114-.198-.011-.304.088-.403.087-.088.197-.232.296-.346.1-.114.133-.198.198-.33.065-.134.034-.248-.015-.347-.05-.1-.445-1.076-.612-1.47-.16-.389-.323-.335-.445-.34-.114-.007-.247-.007-.38-.007a.73.73 0 0 0-.529.247c-.182.198-.691.677-.691 1.654s.71 1.916.81 2.049c.098.133 1.394 2.132 3.383 2.992.47.205.84.326 1.129.418.475.152.904.129 1.246.08.38-.058 1.171-.48 1.338-.943.164-.464.164-.86.114-.943-.049-.084-.182-.133-.38-.232"/>
                   </svg> Compartilhar Imagem (WhatsApp)
                </button>
            </div>
        </div>
    </div>

    <div id="lyricsModal" class="modal">
        <div class="modal-content lyrics-modal-content">
            <span class="modal-close">&times;</span>
            <h3>Copiar Letras Individuais</h3>
            <p class="lyrics-instructions">Clique em cada louvor para copiar seu título e letra (formatado para WhatsApp):</p>
            <div id="lyricsListContainer"></div>
        </div>
    </div>

    <script type="module">
      // Import the functions you need from the SDKs you need
      import { initializeApp } from "https://www.gstatic.com/firebasejs/12.4.0/firebase-app.js";
      // Importa funções do Realtime Database
      import { getDatabase, ref, set, push, onValue, remove } from "https://www.gstatic.com/firebasejs/12.4.0/firebase-database.js";

      // Your web app's Firebase configuration
      const firebaseConfig = {
        apiKey: "AIzaSyD6dCUtxTRcRPTyKwI0Qh9_xspFHC7H9Wg", // MANTENHA A SUA CHAVE AQUI
        authDomain: "lista-louvor.firebaseapp.com",
        projectId: "lista-louvor",
        storageBucket: "lista-louvor.appspot.com", // Verifique se é .appspot.com ou .firebasestorage.app
        messagingSenderId: "963431428345",
        appId: "1:963431428345:web:745121457ddf8b177f3228",
        // Adiciona a URL do seu Realtime Database
        databaseURL: "https://lista-louvor-default-rtdb.firebaseio.com/"
      };

      // Initialize Firebase
      const app = initializeApp(firebaseConfig);

      // Get Database instance
      const database = getDatabase(app);

      // Make database and functions accessible globally for script.js
      // Isso permite que o script.js use as funções importadas aqui
      window.firebaseDb = { database, ref, set, push, onValue, remove };

    </script>

    <script src="script.js"></script>
</body>
</html>
